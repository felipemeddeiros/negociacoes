{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["ListaNegociacoes","Negociacao","Mensagem","NegociacoesView","MensagemView","NegociacaoService","Bind","DateHelper","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_ordemAtual","_service","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texto","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","esvazia","textToDate","value","parseInt","parseFloat","coluna","inverteOrdem","ordena","a","b","focus","negociacaoController","currentInstance"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {ListaNegociacoes} from '../models/ListaNegociacoes';\nimport {Negociacao} from '../models/Negociacao';\nimport {Mensagem} from '../models/Mensagem';\n\nimport {NegociacoesView} from '../views/NegociacoesView';\nimport {MensagemView} from '../views/MensagemView';\n\nimport {NegociacaoService} from '../services/NegociacaoService';\n\nimport {Bind} from '../helpers/Bind';\nimport {DateHelper} from '../helpers/DateHelper';\n\n\nclass NegociacaoController {\n\n\n\tconstructor(){\n\t\n\t\tlet $ = document.querySelector.bind(document);\n\t\n\t\tthis._inputData = $(\"#data\");\n\t\tthis._inputQuantidade = $(\"#quantidade\");\n\t\tthis._inputValor = $(\"#valor\");\n\n\t\tthis._listaNegociacoes = new Bind(\n\t\t\tnew ListaNegociacoes, \n\t\t\tnew NegociacoesView($('#negociacoesView')), \n\t\t\t'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\n\n\t\tthis._mensagem = new Bind(\n\t\t\tnew Mensagem(), \n\t\t\tnew MensagemView($('#mensagemView')), \n\t\t\t'texto');\n\n\t\tthis._ordemAtual = ''; \n\n\t\tthis._service = new NegociacaoService();\n\n\t\tthis._init();\n\t}\n\n\t_init() {\n\n\t\tthis._service\n\t        .lista()\n\t        .then(negociacoes =>\n\t            negociacoes.forEach(negociacao =>\n\t                this._listaNegociacoes.adiciona(negociacao)))\n\t        .catch(erro => this._mensagem.texto = erro);\n\n    \tsetInterval(() => this.importaNegociacoes(), 3000);\n\t}\n\n\tadiciona(event) {\n\n        event.preventDefault();\n\n        let negociacao = this._criaNegociacao();\n\n        this._service\n            .cadastra(negociacao)\n            .then(mensagem => {\n\n                this._listaNegociacoes.adiciona(negociacao);\n                this._mensagem.texto = mensagem; \n                this._limpaFormulario();  \n            \n            }).catch(erro => this._mensagem.texto = erro);\n\t}\n\n\timportaNegociacoes() {\n\n        this._service\n        .importa(this._listaNegociacoes.negociacoes)\n        .then(negociacoes => negociacoes.forEach(negociacao => {\n            this._listaNegociacoes.adiciona(negociacao);\n            this._mensagem.texto = 'Negociações do período importadas'\n          }))\n        .catch(erro => this._mensagem.texto = erro);\n\t}\n\n\tesvazia(){\n\n\t\tthis._service\n\t\t\t.esvazia()\n\t        .then(mensagem => {\n\t            this._mensagem.texto = mensagem;\n\t            this._listaNegociacoes.esvazia();\n\t        })\n\t        .catch(erro => this._mensagem.texto = erro);\n\t}\n\n\t_criaNegociacao(){\n\n\t\treturn new Negociacao(\n\t\t\t\tDateHelper.textToDate(this._inputData.value),\n\t\t\t\tparseInt(this._inputQuantidade.value),\n       \t\t\tparseFloat(this._inputValor.value)\n       \t\t);\n\t}\n\n\tordena(coluna) {\n\n        if(this._ordemAtual == coluna) {\n        \n            this._listaNegociacoes.inverteOrdem();\n        \n        } else {\n\n            this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\n        }\n\n        this._ordemAtual = coluna;\n    }\n\n\t_limpaFormulario(){\n\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\t\tthis._inputData.value = '';\n\n\t\tthis._inputData.focus()\n\t}\n}\n\nlet negociacaoController = new NegociacaoController();\n\nexport function currentInstance() {\n\n    return negociacaoController;\n}"]}